import * as React from "react"
import { PageProps, graphql, HeadFC } from "gatsby"
import { CodeBlock } from "../components/CodeBlocks"
//@ts-ignore
import {MDXProvider} from '@mdx-js/react'
import { MDXRenderer } from "gatsby-plugin-mdx"
//@ts-ignore
import Preamble from "../../content/preamble"

// Can be autogenerated
// https://github.com/cometkim/gatsby-plugin-typegen
type Props = {
  allMdx: {
    nodes: {id: string, body: string,frontmatter: {title: string}}[]
  }
}


const Layout: React.FC<{children: React.ReactNode}> = ({children}) => {
  return (
  <div className="bg-slate-200 flex align-center justify-center max-w-[100vw]">
    <div className="p-10">
    {children}
    </div>
  </div>)
}

const components = {
  pre: (props: any) => (<div {...props}/>),
  code: CodeBlock
}
// TODO add glitch effect to AntiPattern
// TODO white bar to the right when scaling down
const AntiPatternsLogo = () => (
    <div className="flex items-center justify-center font-sans text-[40px] sm:text-[50px]">
      <div>Linguistic</div>
      <div className="-skew-x-[10deg] px-[12px] py-[5px] text-white bg-red-500 ml-[10px]">Antipatterns</div>
  </div>
  )

const IndexPage: React.FC<PageProps<Props>> = ({data}) => {
  return (
    <Layout>
      <div className="pb-10">
        <AntiPatternsLogo />
      </div>
      <div className="prose-sm md:prose max-w-none">
          <Preamble/>
      </div>
      {data.allMdx.nodes.map((node) => (
        <article className="prose-sm md:prose max-w-none">
          <MDXProvider components={components} >
            <MDXRenderer >
              {node.body}
            </MDXRenderer>
          </MDXProvider>
        </article>
      ))}
    </Layout>
  )
}

export default IndexPage


export const query = graphql`
query {
  allMdx {
    nodes {
      id
      body
      frontmatter {
        title	
      }
    }
  }
}
`

export const Head: HeadFC = () => <title>Home Page</title>
